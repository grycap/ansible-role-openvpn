    # Copy of the certificates
    - include: sudo_copy.yml src=/etc/openvpn/easy-rsa/2.0/keys/ca.crt dest=/etc/openvpn/ca.crt mode="0644" owner=root group=root
    - include: sudo_copy.yml src=/etc/openvpn/easy-rsa/2.0/keys/client.crt dest=/etc/openvpn/client.crt mode="0644" owner=root group=root
    - include: sudo_copy.yml src=/etc/openvpn/easy-rsa/2.0/keys/client.key dest=/etc/openvpn/client.key mode="0600" owner=root group=root
 
    # Copy the config file
    - copy: src=/etc/openvpn/client.conf dest=/etc/openvpn/client.conf mode="0644" owner=root group=root

    - name: execute the vpn client
      command: openvpn --config client.conf --daemon --log openvpn_client.log  chdir=/etc/openvpn/ creates=/etc/openvpn/openvpn_client.log
  
    # Manage /etc/hosts of WN and FE
    - name: manage /etc/hosts
      shell: sed -i "/{{openvpn_frontname}}.localdomain/ s/.*/10.8.0.1 {{openvpn_frontname}}.localdomain {{openvpn_frontname}}/g" /etc/hosts
    - shell: ifconfig tun0 | sed -n '/inet addr/s/.*addr.\([^ ]*\) .*/\1/p'
      register: wn_vpn_ip
    - shell: hostname | cut -d "." -f 1
      register: wn_hostname
    - local_action: shell sed -i "/{{wn_hostname.stdout}}.localdomain/ s/.*/{{wn_vpn_ip.stdout}} {{wn_hostname.stdout}}.localdomain {{wn_hostname.stdout}}/g" /etc/hosts
